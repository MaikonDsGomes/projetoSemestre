<!DOCTYPE html>
<html lang="ptbr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atleta - Jiu Connect</title>
    <link rel="stylesheet" href="css/atletas.css">
    <link rel="icon" href="assets/logo.ico" />
</head>

<body onload="atualizarFeed()">
    <section class="menu_sec">

        <header class="menu">
            <div class="centro">
                <h2>Jiu <span>Connect</span></h2>

                <ul class="lista_menu">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="#">Atletas</a></li>
                    <li><a href="index.html#contato_sec">Contato</a></li>
                    <li><span>|</span></li>
                    <li><a href="login.html">Login</a></li>
                    <li><a href="cadastro.html">Cadastro</a></li>
                </ul>
            </div>

        </header>
    </section>
    <section class="atletas_sec">
        <h1>Atletas</h1>

        <div id="modal" class="modal">
            <!-- <h4>Maikon Douglas</h4>
            <p>Team: JFC Almeida</p>
            <p>Faixa: Roxa - 2°</p>
            <p>Descrição: Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis iure ex, exercitationem
                eos expedita aliquam sunt nesciunt provident molestiae, corrupti quibusdam
                quam maiores quo dicta tempore. Perspiciatis repellendus doloremque tenetur.</p>
            <p>Contato: maikon@gmail.com</p>
            <p>Cidade: São Paulo</p>
            <button class="close">Fechar</button> -->
        </div>

        <div class="centro">
            <div id="container" class="atletas_card_box">
                <!-- <div class="card_atleta">
                    <div>
                        <h4>Maikon Douglas</h4>
                        <p>Team: JFC Almeida</p>
                        <p>Faixa: Roxa - 2°</p>
                        <button onclick="abrirModal()">Ver mais</button>
                    </div>
                    <div class="titulo_atleta">
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                    </div>
                </div>
                <div class="card_atleta">
                    <div>
                        <h4>Maikon Douglas</h4>
                        <p>Team: JFC Almeida</p>
                        <p>Faixa: Roxa - 2°</p>
                        <button>Ver mais</button>
                    </div>
                    <div>
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                    </div>
                </div>
                <div class="card_atleta">
                    <div>
                        <h4>Maikon Douglas</h4>
                        <p>Team: JFC Almeida</p>
                        <p>Faixa: Roxa - 2°</p>
                        <button>Ver mais</button>
                    </div>
                    <div>
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                    </div>
                </div>
                <div class="card_atleta">
                    <div>
                        <h4>Maikon Douglas</h4>
                        <p>Team: JFC Almeida</p>
                        <p>Faixa: Roxa - 2°</p>
                        <button>Ver mais</button>
                    </div>
                    <div>
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                    </div>
                </div> -->
            </div>
        </div>
    </section>
</body>

</html>

<script>
    function abrirModal(idAtleta) {
        modal.style.display = "block";

        fetch(`/avisos/listarInfoAtletas/${idAtleta}`).then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("feed_container");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado."
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));

                    var feed = document.getElementById("feed_container");

                    for (let i = 0; i < resposta.length; i++) {
                        var card = resposta[i];

                        var divElement = document.createElement("div");

                        // Criação dos elementos internos
                        var h4Element = document.createElement("h4");
                        var pTeamElement = document.createElement("p");

                        var pDescricaoElement = document.createElement("p");
                        var pContatoElement = document.createElement("p");
                        //var pCidadeElement = document.createElement("p");
                        var buttonElement = document.createElement("button");

                        // Definição do conteúdo dos elementos
                        h4Element.textContent = `${card.nome} ${card.sobrenome}`;
                        pTeamElement.textContent = `Team: ${card.team}`;
                        pDescricaoElement.textContent = `Descrição: ${card.descricao}`;
                        pContatoElement.textContent = `${card.email}`;
                        //pCidadeElement.textContent = "Cidade: São Paulo";
                        buttonElement.textContent = "Fechar";
                        buttonElement.className = "close";
                        buttonElement.setAttribute("onclick", `fecharModal()`);

                        // Adicionando os elementos ao div principal
                        divElement.appendChild(h4Element);
                        divElement.appendChild(pTeamElement);
                        divElement.appendChild(pDescricaoElement);
                        divElement.appendChild(pContatoElement);
                        //divElement.appendChild(pCidadeElement);
                        divElement.appendChild(buttonElement);

                        // Adicionando o divElement ao elemento de destino no DOM (ajuste o seletor conforme necessário)
                        document.getElementById("modal").appendChild(divElement);


                    }

                    finalizarAguardar();
                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
            finalizarAguardar();
        });

    }

    function fecharModal(){
        document.getElementById('modal').style.display = 'none';
        modal.innerHTML = ``
    }
    document.querySelector('.close').addEventListener('click', function () {
       
    });



    function atualizarFeed() {
        fetch("/avisos/listarCardsAtletas").then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("feed_container");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado."
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));

                    var feed = document.getElementById("feed_container");

                    for (let i = 0; i < resposta.length; i++) {
                        var card = resposta[i];

                        var divElement = document.createElement("div");

                        // Criação dos elementos internos
                        var h4Element = document.createElement("h4");
                        var pTeamElement = document.createElement("p");
                        var pFaixaElement = document.createElement("p");
                        var buttonElement = document.createElement("button");

                        divElement.className = `card_atleta`;

                        // Definição do conteúdo e atributos dos elementos
                        h4Element.textContent = `${card.nome} ${card.sobrenome}`;
                        pTeamElement.textContent = `Team: ${card.team}`;
                        pFaixaElement.textContent = `Faixa: ${card.faixa} - ${card.grau}`;
                        buttonElement.textContent = "Ver mais";
                        buttonElement.setAttribute("onclick", `abrirModal(${card.idAtleta})`);

                        // Adicionando os elementos ao div principal
                        divElement.appendChild(h4Element);
                        divElement.appendChild(pTeamElement);
                        divElement.appendChild(pFaixaElement);
                        divElement.appendChild(buttonElement);


                        // Adicionando o cardAtletaElement ao elemento de destino no DOM (ajuste o seletor conforme necessário)
                        document.getElementById("container").appendChild(divElement);


                    }

                    finalizarAguardar();
                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
            finalizarAguardar();
        });
    }


</script>