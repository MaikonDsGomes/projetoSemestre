<!DOCTYPE html>
<html lang="ptbr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atleta - Jiu Connect</title>
    <link rel="stylesheet" href="css/atletas.css">
    <link rel="icon" href="assets/logo.ico" />
</head>

<body onload="atualizarFeed()">
    <section class="menu_sec">

        <header class="menu">
            <div class="centro">
                <h2>Jiu <span>Connect</span></h2>

                <ul class="lista_menu">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="#">Atletas</a></li>
                    <li><a href="index.html#contato_sec">Contato</a></li>
                    <li><span>|</span></li>
                    <li><a href="login.html">Login</a></li>
                    <li><a href="cadastro.html">Cadastro</a></li>
                </ul>
            </div>

        </header>
    </section>
    <section class="atletas_sec">
        <h1>Atletas</h1>

        <div id="modal" class="modal">
            <h4>Maikon Douglas</h4>
            <p>Team: JFC Almeida</p>
            <p>Faixa: Roxa - 2°</p>
            <p>Descrição: Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis iure ex, exercitationem
                eos expedita aliquam sunt nesciunt provident molestiae, corrupti quibusdam
                quam maiores quo dicta tempore. Perspiciatis repellendus doloremque tenetur.</p>
            <p>Contato: maikon@gmail.com</p>
            <p>Cidade: São Paulo</p>
            <button class="close">Fechar</button>
        </div>

        <div class="centro">
            <div id="container" class="atletas_card_box">
                <!-- <div class="card_atleta">
                    <div>
                        <h4>Maikon Douglas</h4>
                        <p>Team: JFC Almeida</p>
                        <p>Faixa: Roxa - 2°</p>
                        <button onclick="abrirModal()">Ver mais</button>
                    </div>
                    <div class="titulo_atleta">
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                    </div>
                </div>
                <div class="card_atleta">
                    <div>
                        <h4>Maikon Douglas</h4>
                        <p>Team: JFC Almeida</p>
                        <p>Faixa: Roxa - 2°</p>
                        <button>Ver mais</button>
                    </div>
                    <div>
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                    </div>
                </div>
                <div class="card_atleta">
                    <div>
                        <h4>Maikon Douglas</h4>
                        <p>Team: JFC Almeida</p>
                        <p>Faixa: Roxa - 2°</p>
                        <button>Ver mais</button>
                    </div>
                    <div>
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                    </div>
                </div>
                <div class="card_atleta">
                    <div>
                        <h4>Maikon Douglas</h4>
                        <p>Team: JFC Almeida</p>
                        <p>Faixa: Roxa - 2°</p>
                        <button>Ver mais</button>
                    </div>
                    <div>
                        <div>
                            <p>Mundial - Abu Dabhi - 20/08/01</p>
                            <p>Posição: 2°</p>
                        </div>
                    </div>
                </div> -->
            </div>
        </div>
    </section>
</body>

</html>

<script>
    function abrirModal() {
        modal.style.display = "block";
    }

    document.querySelector('.close').addEventListener('click', function () {
        document.getElementById('modal').style.display = 'none';
    });



    function atualizarFeed() {
        fetch("/avisos/listarCardsAtletas").then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("feed_container");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado."
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));

                    var feed = document.getElementById("feed_container");
                    
                    for (let i = 0; i < resposta.length; i++) {
                        var card = resposta[i];

                        // Criação do elemento principal (div) e definição da classe
                        var cardAtletaElement = document.createElement("div");
                        cardAtletaElement.className = "card_atleta";

                        // Criação dos elementos internos para o primeiro bloco
                        var divInfoElement = document.createElement("div");
                        var h4Element = document.createElement("h4");
                        var pTeamElement = document.createElement("p");
                        var pFaixaElement = document.createElement("p");
                        var pAnoElement = document.createElement("p");
                        var pPesoElement = document.createElement("p");
                        var buttonElement = document.createElement("button");

                        // Definição do conteúdo e atributos dos elementos
                        h4Element.textContent = `${card.nome} ${card.sobrenome}`;
                        pTeamElement.textContent = `Team: ${card.team}`;
                        pFaixaElement.textContent = `Faixa: ${card.faixa} - ${card.grau}`;
                        pPesoElement.textContent = `Categoria: ${card.peso}`;
                        buttonElement.textContent = "Ver mais";

                        // Adicionando os elementos ao primeiro bloco
                        divInfoElement.appendChild(h4Element);
                        divInfoElement.appendChild(pTeamElement);
                        divInfoElement.appendChild(pFaixaElement);
                        divInfoElement.appendChild(pPesoElement);
                        divInfoElement.appendChild(buttonElement);

                        // Criação do segundo bloco (para os detalhes do campeonato)
                        var divChampionshipWrapper = document.createElement("div");
                        var divChampionship = document.createElement("div");
                        var pEvento = document.createElement("p");
                        var pPosicao = document.createElement("p");

                        // Definição do conteúdo dos elementos do campeonato
                        pEvento.textContent = `${card.federacao} - ${card.campeonato} `;

                        var ano = card.ano.slice(0,10);

                        pAnoElement.textContent = `Data: ${ano}`;
                        pPosicao.textContent = `Posição: ${card.posicao}°`;

                        // Adicionando os elementos do campeonato ao bloco do campeonato
                        divChampionship.appendChild(pEvento);
                        divChampionship.appendChild(pPosicao);
                        divChampionship.appendChild(pAnoElement);
                        
                        // Adicionando o bloco do campeonato ao wrapper do campeonato
                        divChampionshipWrapper.appendChild(divChampionship);

                        // Adicionando os dois blocos ao elemento principal (card_atleta)
                        cardAtletaElement.appendChild(divInfoElement);
                        cardAtletaElement.appendChild(divChampionshipWrapper);

                        // Adicionando o cardAtletaElement ao elemento de destino no DOM (ajuste o seletor conforme necessário)
                        document.getElementById("container").appendChild(cardAtletaElement);


                    }

                    finalizarAguardar();
                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
            finalizarAguardar();
        });
    }


</script>